terraform {
  required_providers {
    vagrant = {
      source  = "bmatcuk/vagrant"
      version = "~> 4.0.0"
    }
  }
}

provider "vagrant" {
  # no config
}

resource "vagrant_vm" "my_vagrant_vm" {
  name = "vagrantbox"
  vagrantfile_dir = "./ubuntu_trusty64/Vagrantfile"
  env = {
    # force terraform to re-run vagrant if the Vagrantfile changes
    VAGRANTFILE_HASH = md5(file("./ubuntu_trusty64/Vagrantfile"))
    # name = "debian-${count.index}"

  }
  count = 3
  get_ports = true
}

resource "vagrant_vm" "master" {
  vagrantfile_dir = "./master"
  env = {
    name = "master"
  }
  get_ports = true
}